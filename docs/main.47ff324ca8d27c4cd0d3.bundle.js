(()=>{"use strict";var e,t={90:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.PIMINUSROTDIFF=t.ROTDIFF=t.DRINKCD=t.POTION=t.WEAPONNAMES=t.WEAPONS=t.ZapIMG=t.LIGHTUPPABLES=t.PLAYERRESPAWNTIME=t.INACTIVEWEPSCALE3DUI=t.ACTIVEWEPSCALE3DUI=t.EXPNEXTLEVELINCREMENTAMT=t.UIBOXALPHA=t.MONSTEROUTOFBOUNDSY=t.OUTOFBOUNDSY=t.POTIONHEALAMT=t.HPBARWIDTH=t.HPCOLOR=t.HALFPI=t.IFRAMES=t.GROUNDTWEENDUR=t.EXP=t.COIN=t.ZAP=t.MAGE=t.PLAYERREF=void 0,t.PLAYERREF={player:null},t.MAGE="mage",t.ZAP="zap",t.COIN="coin",t.EXP="exp",t.GROUNDTWEENDUR=500,t.IFRAMES=30,t.HALFPI=.5*Math.PI,t.HPCOLOR=3330383,t.HPBARWIDTH=400,t.POTIONHEALAMT=20,t.OUTOFBOUNDSY=-10,t.MONSTEROUTOFBOUNDSY=-5,t.UIBOXALPHA=.7,t.EXPNEXTLEVELINCREMENTAMT=10,t.ACTIVEWEPSCALE3DUI=.1,t.INACTIVEWEPSCALE3DUI=.05,t.PLAYERRESPAWNTIME=3e3,t.LIGHTUPPABLES=910,function(e){e.ZAP="zap",e.ZAP2="zap2"}(s=t.ZapIMG||(t.ZapIMG={}));const i={damage:17,cooldown:500,duration:7,spread:!1,shotNum:1,force:10,isUnlocked:!0,cost:0,shopText:"starter wand no one will read this",name:"SingleShot",zapImg:[s.ZAP],recoil:0},o={damage:7,cooldown:800,duration:5,spread:!0,shotNum:8,force:2,isUnlocked:!1,cost:42,shopText:"Shotty with a short \n range zone \n of destruction",name:"Shotty",zapImg:[s.ZAP,s.ZAP2],recoil:2},n={damage:25,cooldown:250,duration:7,spread:!1,shotNum:1,force:13,isUnlocked:!1,cost:88,shopText:"AK-40-Wand that goes \n pew pew pew",name:"Rapid",zapImg:[s.ZAP2],recoil:1};t.WEAPONS={SingleShot:i,Shotty:o,Rapid:n},t.WEAPONNAMES=Object.keys(t.WEAPONS),t.POTION={cost:5,shopText:`A potion that \n restores ${t.POTIONHEALAMT} HP`,name:"Potion",restockTime:1e3},t.DRINKCD=1e3,t.ROTDIFF=Math.PI/24,t.PIMINUSROTDIFF=Math.PI-t.ROTDIFF},985:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,o)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&i(t,e,s);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(s(440)),h=s(277),d=a(s(774)),c=a(s(734)),l=Object.assign({type:r.WEBGL,transparent:!0,scale:{mode:r.Scale.FIT,autoCenter:r.Scale.CENTER_BOTH,width:1280,height:720},scene:[c.default,d.default]},(0,h.Canvas)());window.addEventListener("load",(()=>{(0,h.enable3d)((()=>new r.Game(l))).withPhysics("assets/ammo")}))},372:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,o)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&i(t,e,s);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=s(277),r=s(90),h=s(454),d=s(172),c=n(s(144));t.default=class{constructor(e){this.scene=e}generateGround(){const e=1.0001;for(let t=0;t<30;t++)for(let s=0;s<30;s++){let i=30*t+s,o=Math.floor((0,h.getRandomBetween)(50,150)),n=this.scene.third.physics.add.box({x:5*t*e,y:.1*d.groundHeights[i]-9,z:5*s*e,width:5,depth:5,height:5,mass:0},{lambert:{color:`rgb(${o}, ${o}, ${o})`}});n.body.setCollisionFlags(2),n.body.setAngularFactor(0,0,0),n.body.setLinearFactor(0,0,0),n.userData={isColored:!1,isGround:!0},n.body.on.collision(((o,l)=>{var p;if(o.userData.name===r.ZAP&&!n.userData.isColored){this.scene.third.destroy(n),null===(p=r.PLAYERREF.player)||void 0===p||p.litObject(),n=this.scene.third.physics.add.box({x:5*t*e,y:.1*d.groundHeights[i]-9,z:5*s*e,width:5,depth:5,height:5},{lambert:{color:`rgb(${d.groundRGBs[i][0]}, ${d.groundRGBs[i][1]}, ${d.groundRGBs[i][2]})`}}),n.body.setCollisionFlags(2),n.body.setAngularFactor(0,0,0),n.body.setLinearFactor(0,0,0),n.userData={isColored:!0,isGround:!0};let o=n.position.clone();this.scene.tweens.add({targets:o,ease:"sine.inout",duration:r.GROUNDTWEENDUR,y:"+=1",yoyo:!0,onUpdate:()=>{n.position.set(o.x,o.y,o.z),n.body.needUpdate=!0},onComplete:()=>{this.scene.third.destroy(n),n=this.scene.third.physics.add.box({x:5*t*e,y:.1*d.groundHeights[i]-9,z:5*s*e,width:5,depth:5,height:5,mass:0},{lambert:{color:`rgb(${d.groundRGBs[i][0]}, ${d.groundRGBs[i][1]}, ${d.groundRGBs[i][2]})`}}),n.body.setCollisionFlags(2),n.body.setAngularFactor(0,0,0),n.body.setLinearFactor(0,0,0),n.userData={isColored:!0,isGround:!0}}});const l=(0,h.getRandomBetween)(-2,2),u=o.y+2.5,m=(0,h.getRandomBetween)(-2,2),y=new a.THREE.Vector3(o.x+l,u,o.z+m);new c.default(this.scene,c.ItemTypes.Coin,y);const b=(0,h.getRandomBetween)(-2,2),g=u,D=(0,h.getRandomBetween)(-2,2),P=new a.THREE.Vector3(o.x+b,g,o.z+D);new c.default(this.scene,c.ItemTypes.EXP,P)}}))}}}},172:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.groundHeights=t.groundRGBs=void 0,t.groundRGBs=[[208,180,170],[156,153,97],[208,180,170],[70,108,29],[170,125,105],[225,219,224],[202,171,150],[105,120,36],[191,177,140],[173,164,125],[150,132,99],[181,160,149],[181,154,138],[237,198,184],[173,163,106],[205,202,170],[233,223,227],[156,153,97],[70,96,30],[211,200,205],[206,189,200],[85,113,43],[90,130,35],[102,145,47],[145,152,147],[131,155,159],[131,142,149],[188,209,225],[152,172,184],[151,168,178],[156,153,97],[156,153,97],[156,153,97],[156,153,97],[141,139,127],[74,106,28],[165,145,65],[158,129,109],[226,189,168],[242,207,198],[144,126,106],[233,192,181],[214,186,173],[190,167,143],[156,153,97],[70,96,30],[141,139,127],[222,214,214],[141,139,127],[215,204,210],[189,176,176],[189,189,149],[144,162,116],[159,167,151],[160,156,175],[176,186,201],[160,187,207],[204,226,237],[165,184,198],[154,171,173],[225,219,224],[225,219,224],[146,165,96],[208,180,170],[208,180,170],[156,153,97],[225,219,224],[151,151,68],[141,139,127],[70,96,30],[225,219,224],[126,155,28],[200,166,163],[156,153,97],[70,96,30],[156,153,97],[141,139,127],[225,219,224],[222,207,218],[168,160,150],[106,130,43],[182,172,181],[167,164,179],[162,168,177],[160,167,171],[169,177,188],[197,212,221],[221,225,228],[189,192,196],[170,192,203],[208,180,170],[156,153,97],[141,139,127],[169,173,158],[173,175,149],[208,180,170],[164,162,145],[216,205,210],[141,139,127],[217,187,174],[233,207,196],[179,143,125],[255,230,213],[141,139,127],[237,209,205],[156,153,97],[201,197,193],[214,211,184],[162,170,120],[77,112,46],[87,141,37],[145,156,138],[180,176,191],[155,168,178],[154,170,184],[162,179,188],[138,178,190],[157,173,178],[138,171,181],[138,170,178],[156,153,97],[70,96,30],[208,180,170],[141,139,127],[225,219,224],[98,139,3],[129,145,78],[180,150,127],[181,157,134],[156,153,97],[225,219,224],[134,118,104],[208,180,170],[189,163,148],[225,219,224],[200,171,157],[128,144,63],[134,165,37],[112,139,24],[131,147,84],[174,171,165],[152,150,170],[142,143,157],[153,158,170],[152,160,171],[146,162,178],[119,161,167],[137,162,167],[153,184,190],[141,154,165],[156,153,97],[156,153,97],[156,153,97],[141,139,127],[70,96,30],[156,153,97],[208,180,170],[141,139,127],[255,215,203],[153,137,114],[225,219,224],[128,131,98],[225,219,224],[205,187,159],[105,137,8],[124,156,43],[102,131,12],[126,138,97],[73,112,43],[123,144,79],[179,170,184],[123,135,149],[125,141,158],[109,133,145],[104,137,148],[145,166,181],[96,148,162],[95,149,165],[104,143,161],[110,118,93],[225,219,224],[225,219,224],[225,219,224],[156,153,97],[225,219,224],[156,153,97],[156,153,97],[117,143,18],[156,153,97],[105,117,95],[140,153,80],[89,160,0],[74,103,35],[97,144,0],[116,151,14],[107,152,0],[131,186,0],[94,129,24],[97,134,47],[107,129,101],[105,144,156],[96,125,144],[130,144,160],[143,148,158],[181,173,181],[47,99,123],[6,79,69],[59,87,52],[89,111,60],[72,106,38],[208,180,170],[156,153,97],[106,92,52],[141,139,127],[141,139,127],[225,219,224],[156,153,97],[107,147,2],[141,139,127],[137,152,61],[126,123,142],[149,138,96],[107,127,55],[104,143,53],[72,111,24],[94,134,31],[104,128,52],[129,140,66],[108,131,35],[156,171,87],[138,144,153],[112,136,153],[111,126,149],[128,150,159],[109,141,158],[0,60,84],[79,100,53],[119,143,55],[103,122,46],[105,118,51],[208,180,170],[96,115,53],[225,219,224],[156,153,97],[141,139,127],[141,139,127],[70,96,31],[114,132,77],[142,162,51],[129,157,38],[131,163,140],[121,127,150],[121,132,70],[123,118,67],[128,144,80],[103,149,27],[81,119,22],[123,148,74],[83,121,30],[102,134,59],[162,155,170],[103,133,150],[67,118,145],[112,142,163],[27,102,131],[77,92,39],[128,123,59],[109,111,50],[107,131,46],[113,116,61],[225,219,224],[156,153,97],[141,139,127],[156,153,97],[101,131,57],[94,147,17],[118,144,63],[141,162,56],[152,134,123],[142,141,87],[189,166,166],[126,151,58],[114,153,19],[114,172,32],[71,123,5],[52,86,26],[82,114,44],[122,139,75],[143,143,104],[126,171,0],[172,178,127],[147,156,174],[100,135,155],[92,150,170],[65,108,101],[109,116,45],[140,148,29],[107,133,32],[86,109,27],[103,122,28],[108,98,64],[110,105,64],[100,101,58],[156,153,97],[88,96,62],[105,124,58],[126,140,53],[116,153,26],[154,160,90],[155,146,150],[121,141,61],[90,128,31],[73,121,12],[56,77,36],[118,129,29],[97,120,25],[113,149,23],[103,125,22],[99,125,44],[100,136,12],[132,140,84],[147,157,178],[89,139,159],[73,142,170],[92,114,77],[102,130,56],[75,91,51],[93,127,35],[99,130,38],[80,114,30],[92,96,56],[98,106,48],[102,110,46],[107,93,30],[98,116,34],[99,125,24],[124,121,95],[144,130,146],[92,127,43],[52,87,16],[54,90,18],[89,131,27],[75,114,61],[92,133,38],[103,148,20],[94,120,20],[106,133,48],[106,133,26],[101,121,24],[104,151,5],[106,129,36],[163,160,156],[134,154,168],[96,140,165],[106,148,125],[95,113,32],[88,115,50],[95,111,58],[82,99,29],[70,103,34],[105,134,37],[156,153,97],[120,135,56],[109,125,37],[114,133,43],[126,149,46],[82,119,58],[60,101,77],[72,112,42],[86,129,42],[81,117,42],[92,140,12],[85,143,6],[94,143,20],[117,161,24],[167,161,130],[103,135,32],[99,115,38],[119,121,48],[101,120,29],[96,128,27],[120,138,66],[190,180,195],[127,150,160],[104,151,178],[118,150,110],[94,118,34],[87,108,51],[96,124,36],[110,137,42],[108,124,33],[137,126,60],[116,134,31],[117,136,48],[93,134,9],[35,70,12],[64,93,29],[70,104,36],[83,116,2],[99,117,61],[125,141,105],[130,171,19],[150,163,60],[177,198,120],[136,165,56],[99,119,20],[88,113,74],[120,138,77],[120,149,52],[118,132,27],[105,123,32],[105,123,32],[114,121,54],[183,174,175],[134,163,173],[112,154,158],[108,147,112],[115,139,37],[89,107,27],[105,124,24],[104,132,31],[109,139,35],[92,131,39],[40,76,27],[55,85,29],[66,86,46],[98,102,57],[130,144,17],[125,147,20],[113,127,38],[145,151,74],[143,157,66],[140,156,75],[113,155,31],[116,146,26],[125,164,13],[130,147,33],[150,169,52],[109,139,22],[106,116,42],[110,134,14],[107,111,57],[108,109,42],[130,124,87],[154,160,166],[108,165,184],[83,143,161],[95,136,71],[113,121,19],[90,113,30],[77,115,39],[23,50,19],[50,94,10],[73,103,44],[103,139,54],[103,141,48],[136,150,84],[114,137,51],[119,152,70],[100,113,47],[103,133,16],[99,131,38],[134,141,89],[165,176,100],[137,177,4],[127,169,45],[141,167,72],[143,165,38],[128,150,37],[116,138,28],[82,109,53],[102,141,50],[124,139,52],[88,123,35],[111,128,84],[143,182,192],[89,161,183],[118,155,128],[106,129,48],[103,123,41],[77,98,48],[101,124,38],[114,134,35],[120,135,33],[101,113,48],[88,114,26],[131,140,135],[140,169,185],[101,128,42],[93,114,31],[88,116,39],[89,114,23],[96,127,17],[91,125,14],[79,121,19],[90,134,13],[93,140,3],[90,134,13],[95,118,68],[89,127,50],[97,111,29],[103,120,42],[82,109,53],[90,134,13],[107,137,37],[90,117,69],[113,184,193],[76,107,55],[105,119,91],[98,114,33],[110,124,53],[129,149,56],[112,133,70],[132,142,114],[135,109,82],[146,131,89],[141,139,127],[160,155,166],[154,144,105],[103,117,47],[100,146,1],[105,134,36],[118,114,56],[97,103,42],[89,123,42],[84,113,40],[103,142,21],[90,134,13],[108,139,29],[116,123,55],[90,134,13],[112,135,39],[107,137,37],[76,107,55],[90,134,13],[76,107,55],[90,117,69],[107,137,37],[76,107,55],[106,131,46],[99,92,50],[68,109,7],[84,80,49],[70,96,30],[102,117,42],[111,113,47],[84,96,41],[106,135,51],[127,117,73],[106,125,49],[133,137,75],[124,147,60],[108,144,28],[113,138,49],[111,133,44],[82,109,53],[82,109,53],[97,114,38],[111,129,45],[56,77,63],[90,117,69],[90,117,69],[76,107,55],[89,132,67],[90,117,69],[76,107,55],[89,132,67],[76,107,55],[76,107,55],[99,119,52],[83,108,31],[91,128,29],[81,89,44],[106,131,21],[108,131,45],[106,123,44],[105,117,47],[91,112,24],[96,121,27],[102,122,42],[72,105,23],[88,116,28],[90,134,13],[72,89,37],[86,115,49],[90,134,13],[124,135,67],[123,149,38],[131,143,101],[82,109,53],[107,137,37],[90,134,13],[107,137,37],[90,134,13],[90,117,69],[107,137,37],[89,132,67],[76,107,55],[61,70,91],[76,91,40],[102,126,35],[84,102,19],[121,117,45],[104,98,52],[113,119,36],[128,120,57],[90,134,13],[101,114,52],[98,114,49],[118,128,47],[90,134,13],[95,107,43],[107,114,56],[123,126,48],[90,134,13],[82,109,53],[90,117,69],[90,134,13],[107,137,37],[82,109,53],[107,137,37],[76,107,55],[107,137,37],[76,107,55],[76,107,55],[76,107,55],[90,117,69],[76,107,55],[72,80,59],[83,107,45],[95,115,35],[127,142,29],[95,114,52],[87,102,38],[105,123,32],[128,129,45],[102,118,58],[109,116,58],[110,124,40],[120,141,33],[140,142,51],[145,144,48],[150,158,34],[120,147,80],[82,109,53],[90,134,13],[56,77,63],[82,109,53],[76,107,55],[107,137,37],[90,117,69],[56,77,63],[76,107,55],[76,107,55],[90,91,66],[92,102,42],[77,98,50],[85,124,38],[85,109,49],[93,100,75],[106,129,38],[87,102,57],[120,126,40],[108,112,43],[119,126,53],[112,118,72],[125,134,53],[138,137,51],[144,156,82],[162,168,116],[163,179,112],[182,205,170],[142,174,151],[161,183,187],[90,117,69],[107,137,37],[76,107,55],[107,137,37],[90,117,69],[89,132,67],[89,132,67],[85,94,60],[82,111,38],[88,110,37],[90,110,63],[86,117,65],[89,132,67],[74,106,32],[82,108,49],[59,84,39],[126,123,55],[115,125,40],[122,142,60],[116,143,56],[88,105,55],[98,125,33],[137,171,70],[109,136,78],[185,194,198],[219,225,242],[236,245,255],[198,199,214],[166,150,163],[115,116,95],[107,122,68],[89,132,67],[76,107,55],[107,137,37],[89,132,67],[90,117,69],[82,113,52],[89,118,72],[83,108,68],[76,101,61],[76,107,55],[54,84,42],[70,98,43],[78,113,38],[74,112,50],[81,94,52],[106,119,54],[89,118,52],[91,121,68],[99,124,70],[98,126,42],[183,195,178],[210,224,250],[181,180,184],[183,182,189],[232,245,251],[173,169,182],[126,127,113],[83,111,52],[97,125,70],[83,110,58],[108,142,46],[90,134,13],[96,126,69],[99,133,71],[89,121,61],[88,120,47],[84,116,60],[80,102,64],[96,102,69],[88,122,52],[95,119,70],[85,105,62],[97,117,51],[89,97,75],[78,103,38],[97,126,74],[104,138,70],[110,138,62],[198,216,206],[194,197,217],[213,211,218],[204,195,203],[210,203,209],[221,235,243],[171,177,196],[131,130,118],[72,102,52],[108,118,65],[107,133,68],[111,129,85],[102,143,26],[97,116,72],[104,129,80],[100,132,70],[79,111,53],[90,118,69],[78,107,66],[84,114,63],[68,92,62],[85,88,60],[75,101,56],[82,109,62],[101,130,52],[94,118,54],[68,90,58],[99,136,47],[133,154,117],[221,236,255],[252,254,255],[202,210,216],[201,199,204],[190,183,187],[171,183,196],[180,196,213],[160,161,185],[101,128,73],[114,140,94],[99,132,58],[88,119,48],[83,111,60],[109,141,53],[100,117,57],[112,133,134],[95,109,90],[90,117,69],[87,111,51],[78,105,61],[100,105,67],[90,101,51],[56,89,48],[66,93,49],[84,123,28],[64,81,48],[68,97,55],[61,102,33],[185,180,191],[191,193,205],[206,230,240],[197,217,228],[214,224,233],[200,202,211],[192,191,200],[178,181,191],[209,218,235],[117,148,114],[96,126,61],[94,112,72],[105,115,63],[79,99,70],[100,125,30],[72,92,53],[94,120,57],[98,114,73],[64,83,50],[75,90,62],[95,106,78],[84,90,63],[84,91,55],[82,115,53],[72,106,41],[79,101,46],[84,107,55],[71,102,33],[87,105,50],[76,93,43],[172,166,170],[199,208,216],[173,193,200],[200,215,224],[200,215,225],[179,188,203],[182,179,184],[176,186,199],[175,182,209],[151,163,129],[106,137,70],[106,132,83],[97,113,70],[95,117,54],[88,105,57],[118,143,76],[98,121,48],[107,138,83],[90,116,79],[98,120,75],[93,118,77],[95,117,65],[101,116,74],[75,94,36],[93,125,39],[94,118,56],[90,119,43],[78,111,46],[69,107,43],[84,116,26],[97,113,72],[170,170,181],[175,193,201],[199,219,229],[168,188,202],[184,206,222],[156,164,181],[147,157,180],[152,146,170],[101,108,68],[127,138,84],[71,96,60],[85,109,64],[83,112,53],[82,101,55],[82,109,53],[82,113,65],[95,119,58],[109,137,61],[94,122,58],[104,134,82],[102,136,102],[56,77,63],[108,101,69],[81,89,57],[90,113,64],[90,109,66],[72,94,62],[96,119,45],[84,103,48]],t.groundHeights=[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,40,40,40,30,30,30,30,30,30,20,20,20,20,20,20,50,50,50,50,60,50,50,50,50,50,50,50,50,50,50,40,40,40,30,30,30,30,30,20,20,20,20,20,20,20,50,50,50,50,60,50,50,50,50,50,50,50,50,50,50,40,40,40,30,30,30,30,20,20,20,20,20,20,20,20,50,50,50,50,50,50,50,50,50,50,50,50,50,50,40,40,40,40,30,30,30,30,20,20,20,20,20,20,20,20,50,50,50,50,50,50,50,50,50,50,50,50,40,40,40,40,40,40,30,30,20,20,20,20,20,20,20,20,20,20,50,50,50,50,50,50,50,50,50,50,50,50,40,40,40,40,40,30,30,30,20,20,20,20,20,20,20,20,20,60,50,50,50,50,50,50,50,50,50,50,50,40,40,40,40,40,40,30,30,30,20,20,20,20,20,20,60,60,60,60,50,50,50,50,50,50,50,50,50,50,40,40,40,40,40,40,40,30,30,30,20,20,20,20,20,60,60,60,60,60,50,50,50,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,30,30,20,20,20,20,60,60,60,60,60,60,50,50,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,30,30,30,20,20,20,60,60,60,60,50,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,30,30,30,20,20,20,60,60,60,50,50,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,30,30,30,20,20,20,60,60,60,50,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,50,50,50,40,40,40,30,30,30,20,20,20,60,60,50,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,50,50,50,50,40,40,30,30,30,30,20,20,20,60,60,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,50,50,50,40,40,40,30,30,30,20,20,20,60,60,50,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,60,60,60,20,20,60,60,50,40,40,40,40,40,50,60,60,60,40,40,40,40,40,40,40,40,40,40,40,40,40,60,60,60,60,20,60,60,50,40,50,50,50,50,50,60,60,60,40,40,40,40,40,40,40,40,40,40,40,40,40,40,60,60,60,60,60,60,50,50,50,50,50,50,50,60,60,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,60,60,60,60,60,60,50,50,50,50,50,50,50,40,40,40,40,40,40,40,40,40,50,50,40,40,40,40,60,60,60,60,60,60,60,50,50,50,50,50,50,50,40,40,40,30,30,30,30,30,30,60,60,50,50,40,40,60,60,60,60,60,60,60,60,50,50,50,50,50,50,40,40,40,30,30,30,30,30,30,30,60,60,50,50,40,40,60,60,60,70,70,70,60,60,50,50,50,40,40,40,40,40,30,30,30,30,20,20,20,20,60,60,50,50,40,40,60,60,70,70,70,70,60,60,50,50,50,40,40,40,40,30,30,30,20,20,20,20,20,60,60,60,50,50,40,40,70,70,70,70,70,70,60,50,50,50,40,40,40,30,30,30,30,20,20,20,20,20,60,60,60,60,50,50,40,40,70,70,70,70,70,70,50,50,50,50,40,40,30,30,30,30,30,20,20,20,20,60,60,60,60,60,50,50,40,40,70,70,70,70,70,70,50,50,50,50,30,30,30,30,20,20,20,20,20,20,60,60,60,60,60,50,50,50,40,40,70,70,70,70,70,70,50,50,50,60,30,30,30,20,20,20,20,20,20,60,60,60,60,60,50,50,50,40,40,40,50,50,50,50,50,50,50,50,60,60,30,30,20,20,20,20,20,20,20,60,60,60,60,50,50,50,40,40,40,40,50,50,50,50,50,50,50,60,60,60,30,20,20,20,20,20,20,20,20,60,60,60,50,50,50,40,40,40,40,40,40,50,50,50,50,50,50,60,60,60]},144:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemTypes=void 0;const i=s(90),o=s(454);var n;!function(e){e[e.EXP=0]="EXP",e[e.Coin=1]="Coin"}(n=t.ItemTypes||(t.ItemTypes={}));const a=.15;t.default=class{constructor(e,t,s,i=!1){this.scene=e,this.itemType=t,this.emitPos=s,this.flyTowardsPlayer=i,t===n.Coin?(this.constructCoin(),this.flyTowardsPlayer?this.flyTowardsAndAutoCollect():this.slowlyFadeAway(.2)):t===n.EXP&&(this.constructEXP(),this.flyTowardsPlayer?this.flyTowardsAndAutoCollect():this.slowlyFadeAway(a))}constructCoin(){this.itemObj3D=this.scene.third.add.cylinder({x:this.emitPos.x,y:this.emitPos.y,z:this.emitPos.z,radiusBottom:.2,radiusTop:.2,height:.1},{phong:{color:"gold",transparent:!0,opacity:1}}),this.itemObj3D.userData.name=i.COIN}constructEXP(){const e=(0,o.getRandomBetween)(.7,1);this.itemObj3D=this.scene.third.add.sphere({x:this.emitPos.x,y:this.emitPos.y,z:this.emitPos.z,radius:a*e*1.1},{phong:{color:"green",transparent:!0,wireframe:!0}});const t=this.scene.third.add.sphere({radius:a*e*.7},{phong:{color:"yellow",transparent:!0}});this.itemObj3D.add(t),this.itemObj3D.userData.name=i.EXP}flyTowardsAndAutoCollect(){var e,t,s;if(!i.PLAYERREF.player)return;let n,a=this.itemObj3D.position.clone();const r={targets:a,ease:"sine.inout",duration:300,x:null===(e=i.PLAYERREF.player)||void 0===e?void 0:e.position.x,y:(null===(t=i.PLAYERREF.player)||void 0===t?void 0:t.position.y)-1,z:null===(s=i.PLAYERREF.player)||void 0===s?void 0:s.position.z,onUpdate:()=>{this.itemObj3D.position.set(a.x,a.y,a.z),this.itemObj3D.rotateZ(.4),this.itemObj3D.rotateY(.2)},onComplete:()=>{var e;null==n||n.remove(),n=void 0,null===(e=i.PLAYERREF.player)||void 0===e||e.pickUp(this.itemType),(0,o.disposeMesh)(this.scene,this.itemObj3D)}};this.scene.tweens.add({targets:a,ease:"sine.inout",duration:400,y:"+=2",useFrames:!1,onUpdate:()=>{this.itemObj3D.position.set(a.x,a.y,a.z),this.itemObj3D.rotateZ(.2),this.itemObj3D.rotateY(.2)},onComplete:()=>{n=this.scene.tweens.add(r)}})}slowlyFadeAway(e){const t=1/300;let s,n=!1,a=this.itemObj3D.position.clone(),r=2*e;const h=[a.x-r,a.x+r],d=[a.z-r,a.z+r],c={targets:a,ease:"sine.inout",duration:18.75,y:"+=1",useFrames:!0,repeat:8,yoyo:!0,onUpdate:()=>{var e;if(!n&&(0,o.checkCollisionWithPlayer)(h,d))return(0,o.disposeMesh)(this.scene,this.itemObj3D),null==s||s.remove(),s=void 0,n=!0,void(null===(e=i.PLAYERREF.player)||void 0===e||e.pickUp(this.itemType));this.itemObj3D.position.set(a.x,a.y,a.z),this.itemObj3D.rotateZ(.4),this.itemObj3D.rotateY(.2),this.itemObj3D.material.opacity-=t,this.itemObj3D.children.forEach((e=>{e.material.opacity-=t}))},onComplete:()=>{(0,o.disposeMesh)(this.scene,this.itemObj3D)}};this.scene.tweens.add({targets:a,ease:"sine.inout",duration:.8*i.GROUNDTWEENDUR,y:"+=2",useFrames:!1,yoyo:!0,onUpdate:()=>{this.itemObj3D.position.set(a.x,a.y,a.z),this.itemObj3D.rotateZ(.2),this.itemObj3D.rotateY(.2)},onComplete:()=>{s=this.scene.tweens.add(c)}})}}},501:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,o)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&i(t,e,s);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MonsterStates=t.MonsterTypes=void 0;const a=s(277),r=s(90),h=s(454),d=n(s(144));var c,l;!function(e){e[e.Knight=0]="Knight",e[e.Bishop=1]="Bishop",e[e.Rook=2]="Rook",e[e.Boss=3]="Boss"}(c=t.MonsterTypes||(t.MonsterTypes={})),function(e){e[e.Idle=0]="Idle",e[e.BossIdle=1]="BossIdle",e[e.DetectsPlayer=2]="DetectsPlayer",e[e.ReturningToSpawn=3]="ReturningToSpawn",e[e.Dead=4]="Dead"}(l=t.MonsterStates||(t.MonsterStates={})),t.default=class{constructor(e,t,s,i,o){this.damage=5,this.currentHP=100,this.maxHP=100,this.respawnTime=1e3,this.expAmount=2,this.coinAmount=2,this.speed=1.5,this.canJump=!1,this.jumpCooldown=2e3,this.prevJumpTime=0,this.currentState=l.Idle,this.prevDmgTime=0,this.dmgCooldown=200,this.specialCooldown=6e3,this.prevSpecialTime=0,this.prevProjectileTime=0,this.projectileCooldown=3e3,this.tpingAway=!1,this.lockedPlayerIn=!1,this.scene=e,this.monsterType=t,this.monsterObj3D=new a.ExtendedObject3D,this.copyIncomingMonsterData(o);const n=i.clone(!0);n.position.set(0,0,0),this.monsterObj3D.add(n);const d=Math.floor((0,h.getRandomBetween)(0,255)),p=Math.floor((0,h.getRandomBetween)(0,255)),u=Math.floor((0,h.getRandomBetween)(0,255));this.monsterObj3D.traverse((e=>{e.material&&e.material.color.setRGB(d,p,u)})),this.spawnPos=s,this.monsterType===c.Boss?this.monsterObj3D.position.set(s.x,s.y+100,s.z):this.monsterObj3D.position.set(s.x,s.y,s.z),this.scene.third.add.existing(this.monsterObj3D),this.scene.third.physics.add.existing(this.monsterObj3D,{shape:"box",height:1.2,width:.7,depth:.7,mass:100,offset:{y:-.55}}),this.monsterObj3D.body.on.collision(((e,t)=>{r.PLAYERREF.player&&(e.userData.name===r.MAGE&&this.currentState!==l.Dead&&this.dealDamage(),this.currentState===l.Dead||e.userData.name!==r.ZAP||e.userData.hitMonster||(this.tookDamage(e.userData.damage*r.PLAYERREF.player.dmgFactor),e.userData.hitMonster=!0))}));const m=this.monsterType===c.Boss?2:1.2;this.hpBar=new a.ExtendedObject3D,this.hpBar=this.scene.third.add.box({width:m,height:.1,depth:.1,y:1.3},{lambert:{color:r.HPCOLOR}}),this.monsterObj3D.add(this.hpBar);const y=this.scene.third.add.box({y:-.5});y.visible=!1,this.monsterObj3D.add(y),this.scene.third.physics.add.existing(y,{mass:1e-8,shape:"box",width:.2,height:.2,depth:.2,collisionFlags:4}),this.scene.third.physics.add.constraints.lock(this.monsterObj3D.body,y.body),y.body.on.collision(((e,t)=>{e.userData.isGround&&(this.canJump="end"!==t)})),this.monsterObj3D.body.setAngularFactor(0,0,0),this.monsterType===c.Boss&&(this.loadCastleAndDoor(),this.monsterObj3D.body.setCollisionFlags(2)),this.monsterObj3D.body.setBounciness(1),this.monsterObj3D.userData.isGround=!0}copyIncomingMonsterData(e){this.damage=e.damage,this.maxHP=this.currentHP=e.maxHP,this.respawnTime=e.respawnTime,this.expAmount=e.expAmount,this.coinAmount=e.coinAmount,this.speed=e.speed,this.canJump=e.canJump,this.jumpCooldown=e.jumpCooldown,this.currentState=e.currentState,this.prevDmgTime=e.prevDmgTime,this.dmgCooldown=e.dmgCooldown,this.specialCooldown=e.specialCooldown,this.prevSpecialTime=e.prevSpecialTime,this.prevProjectileTime=e.prevProjectileTime,this.projectileCooldown=e.projectileCooldown,this.xRange=e.xRange,this.zRange=e.zRange}moveToSpawn(){const e=new a.THREE.Vector3,t=new a.THREE.Vector3;this.monsterObj3D.getWorldPosition(e),e.distanceTo(this.spawnPos)>5?(t.subVectors(this.spawnPos,e),t.normalize(),this.monsterObj3D.body.setVelocityX(t.x*this.speed),this.monsterObj3D.body.setVelocityZ(t.z*this.speed)):this.currentState=l.Idle}bossTPAway(){this.tpingAway=!0,setTimeout((()=>{this.monsterObj3D.body.setCollisionFlags(2),this.monsterObj3D.rotation.set(0,0,0),this.monsterObj3D.position.set(this.spawnPos.x,this.spawnPos.y+100,this.spawnPos.z),this.monsterObj3D.body.needUpdate=!0,this.tpingAway=!1,this.openDoor(),this.monsterObj3D.body.once.update((()=>{this.currentState=l.BossIdle,this.monsterObj3D.body.setVelocity(0,0,0),this.monsterObj3D.body.setAngularVelocity(0,0,0)}))}),1.5*r.PLAYERRESPAWNTIME)}loadCastleAndDoor(){const e=Math.floor((0,h.getRandomBetween)(0,255)),t=Math.floor((0,h.getRandomBetween)(0,255)),s=Math.floor((0,h.getRandomBetween)(0,255));this.scene.third.load.gltf("assets/glb/Castle.glb").then((i=>{const o=new a.ExtendedObject3D;o.add(i.scene),o.position.set(130,.45,100),o.rotateY(3.14),this.scene.third.add.existing(o),this.scene.third.physics.add.existing(o,{shape:"concaveMesh",mass:0}),o.traverse((i=>{i.isMesh&&i.material&&i.material.color.setRGB(e,t,s)})),this.scene.third.animationMixers.add(o.anims.mixer),i.animations.forEach((e=>{e.name&&o.anims.add(e.name,e)})),o.anims.play("draining")})),this.scene.third.load.gltf("assets/glb/Door.glb").then((i=>{this.castleDoor=new a.ExtendedObject3D,this.castleDoor.add(i.scene),this.castleDoor.position.set(130,.45,100),this.castleDoor.rotateY(3.14),this.scene.third.add.existing(this.castleDoor),this.scene.third.physics.add.existing(this.castleDoor,{shape:"concaveMesh",mass:0,collisionFlags:2}),this.castleDoor.traverse((i=>{i.isMesh&&i.material&&i.material.color.setRGB(e,t,s)})),this.openDoor()}))}lockPlayerIn(){var e;this.lockedPlayerIn||(this.lockedPlayerIn=!0,this.castleDoor.position.set(130,.45,100),this.castleDoor.body.needUpdate=!0,null===(e=r.PLAYERREF.player)||void 0===e||e.bossFight())}openDoor(){this.lockedPlayerIn=!1,this.castleDoor.position.set(10,-20,10),this.castleDoor.body.needUpdate=!0}moveTowardsPlayer(){if(!r.PLAYERREF.player)return;const e=new a.THREE.Vector3,t=new a.THREE.Vector3,s=new a.THREE.Vector3;this.monsterObj3D.getWorldPosition(t),r.PLAYERREF.player.getWorldPosition(s),e.subVectors(s,t),this.monsterObj3D.body.setVelocity(e.x*this.speed,e.y*this.speed,e.z*this.speed)}moveForwards(){const e=new a.THREE.Vector3;this.monsterObj3D.getWorldDirection(e),this.monsterObj3D.body.setVelocityX(e.x*this.speed),this.monsterObj3D.body.setVelocityZ(e.z*this.speed)}rotateTowardsPlayer(){if(!r.PLAYERREF.player)return;const e=new a.THREE.Vector3,t=new a.THREE.Vector3,s=new a.THREE.Vector3,i=new a.THREE.Vector3;this.monsterObj3D.getWorldPosition(t),r.PLAYERREF.player.getWorldPosition(e),s.subVectors(e,t);const o=Math.atan2(s.x,s.z);this.monsterObj3D.getWorldDirection(i);const n=Math.atan2(i.x,i.z);this.monsterObj3D.body.setAngularVelocityY(0);const h=Math.abs(o-n);let d=5;h>r.ROTDIFF&&(h>r.PIMINUSROTDIFF&&(d*=-1),o<n&&(d*=-1),this.monsterObj3D.body.setAngularVelocityY(d))}respawn(){this.monsterObj3D.body.setCollisionFlags(2),this.monsterObj3D.rotation.set(0,0,0),this.monsterObj3D.position.set(this.spawnPos.x,this.spawnPos.y,this.spawnPos.z),this.monsterObj3D.body.needUpdate=!0,this.monsterObj3D.body.once.update((()=>{this.currentState=l.Idle,this.monsterObj3D.body.setCollisionFlags(0),this.monsterObj3D.body.setVelocity(0,0,0),this.monsterObj3D.body.setAngularVelocity(0,0,0)}))}spinAttack(e){if(e-this.prevSpecialTime>this.specialCooldown){if(!r.PLAYERREF.player)return;const t=new a.THREE.Vector3;this.monsterObj3D.getWorldDirection(t),t.multiplyScalar(2);const s=r.PLAYERREF.player.position.x+t.x,i=r.PLAYERREF.player.position.y+t.y+1,o=r.PLAYERREF.player.position.z+t.z;this.prevSpecialTime=e;let n=this.monsterObj3D.position.clone();this.monsterObj3D.body.setCollisionFlags(2),this.scene.tweens.add({targets:n,ease:"linear",duration:1e3,x:s,y:i,z:o,onUpdate:()=>{this.monsterObj3D.position.set(n.x,n.y,n.z),this.monsterObj3D.rotateY(.2),this.monsterObj3D.body.needUpdate=!0},onComplete:()=>{this.monsterObj3D.body.needUpdate=!0,this.monsterObj3D.body.setCollisionFlags(0),this.monsterObj3D.body.setVelocity(0,0,0),this.monsterObj3D.body.setAngularVelocity(0,0,0)}})}}shootProjectile(e){if(e-this.prevProjectileTime>this.projectileCooldown){this.prevProjectileTime=e;const t=new a.THREE.Vector3,s=new a.THREE.Vector3,i=new a.THREE.Vector3;this.monsterObj3D.getWorldDirection(i),this.monsterObj3D.getWorldDirection(t),this.monsterObj3D.getWorldPosition(s),t.addVectors(t,s);const o=this.scene.third.physics.add.sphere({radius:.5,x:t.x,y:t.y,z:t.z,mass:10},{lambert:{color:"red",transparent:!0,opacity:.5}});o.body.setGravity(0,-1,0),o.body.on.collision(((e,t)=>{e.userData.name===r.MAGE&&this.dealDamage()})),i.multiplyScalar(70),o.body.applyForce(i.x,i.y,i.z),setTimeout((()=>{this.scene.third.destroy(o)}),3e3)}}checkIfPlayerInRange(){if(!r.PLAYERREF.player)return;const e=this.monsterObj3D.position;if(Math.abs(r.PLAYERREF.player.position.y-e.y)>1.5)return;const t=[e.x-30,e.x+30],s=[e.z-30,e.z+30];(0,h.checkCollisionWithPlayer)(t,s)&&(this.currentState=l.DetectsPlayer)}bossCheckIfPlayerInRange(){this.xRange&&this.zRange&&(0,h.checkCollisionWithPlayer)(this.xRange,this.zRange)&&(this.monsterObj3D.position.set(this.spawnPos.x,this.spawnPos.y,this.spawnPos.z),this.monsterObj3D.body.setCollisionFlags(0),this.monsterObj3D.body.needUpdate=!0,this.currentState=l.DetectsPlayer)}jump(e){this.canJump&&e-this.prevJumpTime>this.jumpCooldown&&(this.monsterObj3D.body.setVelocityY(6),this.prevJumpTime=e)}dealDamage(){var e;const t=this.scene.time.now;this.scene.time.now-this.prevDmgTime>this.dmgCooldown&&(null===(e=r.PLAYERREF.player)||void 0===e||e.tookDamage(this.damage),this.prevDmgTime=t)}tookDamage(e){this.tpingAway||(this.currentHP-=e,this.hpBar.scale.set(this.currentHP/this.maxHP,1,1),this.currentHP<=0&&this.dieAndEmitGoodies(),this.currentState!==l.Idle&&this.currentState!==l.BossIdle&&this.currentState!==l.ReturningToSpawn||(this.currentState=l.DetectsPlayer))}dieAndEmitGoodies(){var e;this.currentState=l.Dead,this.hpBar.scale.setScalar(0),this.monsterType===c.Boss&&(this.openDoor(),null===(e=r.PLAYERREF.player)||void 0===e||e.playBossVictorySequence()),this.monsterObj3D.body.setAngularVelocity(Math.random(),Math.random(),Math.random());const t=e=>{e<this.expAmount&&(new d.default(this.scene,d.ItemTypes.EXP,this.monsterObj3D.position,!0),setTimeout((()=>{t(++e)}),300))};setTimeout((()=>{t(0)}));const s=e=>{e<this.coinAmount&&(new d.default(this.scene,d.ItemTypes.Coin,this.monsterObj3D.position,!0),setTimeout((()=>{s(++e)}),300))};setTimeout((()=>{s(0)}),75),setTimeout((()=>{this.hpBar.scale.setScalar(1),this.currentHP=this.maxHP,this.monsterType===c.Boss?this.bossTPAway():this.respawn()}),this.respawnTime)}checkIfPlayerAlive(){var e;(null===(e=r.PLAYERREF.player)||void 0===e?void 0:e.isAlive())||(this.currentState=l.ReturningToSpawn)}checkIfPlayerRespawning(){var e;(null===(e=r.PLAYERREF.player)||void 0===e?void 0:e.isRespawning())&&(this.currentState=l.ReturningToSpawn)}update(e,t){if(this.monsterType!==c.Boss)this.monsterObj3D.position.y<r.MONSTEROUTOFBOUNDSY&&this.currentState!==l.Dead&&this.respawn(),this.currentState===l.Idle?this.checkIfPlayerInRange():this.currentState===l.DetectsPlayer?(this.checkIfPlayerAlive(),this.checkIfPlayerRespawning(),this.rotateTowardsPlayer(),this.jump(e),this.moveForwards(),this.monsterType===c.Rook&&this.spinAttack(e),this.monsterType===c.Bishop&&this.shootProjectile(e)):this.currentState===l.ReturningToSpawn?(this.moveToSpawn(),this.jump(e)):(this.currentState,l.Dead);else if(this.currentState===l.BossIdle||this.currentState===l.Idle)this.bossCheckIfPlayerInRange();else if(this.currentState===l.DetectsPlayer)this.lockPlayerIn(),this.checkIfPlayerRespawning(),this.rotateTowardsPlayer(),this.jump(e),this.moveForwards(),this.spinAttack(e),this.shootProjectile(e);else if(this.currentState===l.ReturningToSpawn){if(this.tpingAway)return;this.bossTPAway()}}}},925:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MONSTERBOSSDATA=t.MONSTERROOKDATA=t.MONSTERBISHOPDATA=t.MONSTERKNIGHTDATA=t.MONSTERTESTDATA=void 0;const i=s(501);t.MONSTERTESTDATA={damage:5,maxHP:100,respawnTime:1e3,expAmount:2,coinAmount:2,speed:2,canJump:!1,jumpCooldown:2e3,prevJumpTime:0,currentState:i.MonsterStates.BossIdle,prevDmgTime:0,dmgCooldown:200,specialCooldown:5500,prevSpecialTime:0,prevProjectileTime:0,projectileCooldown:2500,xRange:[25,60],zRange:[25,60]},t.MONSTERKNIGHTDATA={damage:5,maxHP:100,respawnTime:25e3,expAmount:2,coinAmount:2,speed:1.5,canJump:!1,jumpCooldown:1700,prevJumpTime:0,currentState:i.MonsterStates.Idle,prevDmgTime:0,dmgCooldown:200,specialCooldown:6e3,prevSpecialTime:0,prevProjectileTime:0,projectileCooldown:3e3},t.MONSTERBISHOPDATA={damage:8,maxHP:150,respawnTime:4e4,expAmount:4,coinAmount:4,speed:1.5,canJump:!1,jumpCooldown:2e3,prevJumpTime:0,currentState:i.MonsterStates.Idle,prevDmgTime:0,dmgCooldown:200,specialCooldown:6e3,prevSpecialTime:0,prevProjectileTime:0,projectileCooldown:3e3},t.MONSTERROOKDATA={damage:10,maxHP:200,respawnTime:5e4,expAmount:8,coinAmount:8,speed:1.5,canJump:!1,jumpCooldown:1900,prevJumpTime:0,currentState:i.MonsterStates.Idle,prevDmgTime:0,dmgCooldown:200,specialCooldown:6e3,prevSpecialTime:0,prevProjectileTime:0,projectileCooldown:3e3},t.MONSTERBOSSDATA={damage:14,maxHP:1e3,respawnTime:12e5,expAmount:50,coinAmount:50,speed:2,canJump:!1,jumpCooldown:2e3,prevJumpTime:0,currentState:i.MonsterStates.BossIdle,prevDmgTime:0,dmgCooldown:200,specialCooldown:5500,prevSpecialTime:0,prevProjectileTime:0,projectileCooldown:2500,xRange:[114.6,127.5],zRange:[109.5,122]}},444:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NpcTypes=void 0;const i=s(454),o=s(90);var n;!function(e){e[e.Interactable=0]="Interactable",e[e.Background=1]="Background",e[e.ShopItem=2]="ShopItem"}(n=t.NpcTypes||(t.NpcTypes={})),t.default=class{constructor(e,t,s,i,o){this.scene=e,this.npcType=t,this.spawnPos=s,o&&(this.shopItemData=o),t===n.Background?this.constructBackgroundNpc():t===n.Interactable?i&&(this.npcObj3D=i,this.npcObj3D.position.set(s.x,s.y,s.z)):t===n.ShopItem&&i&&this.constructShopItem(i)}getRandomRGB(){return{r:Math.floor((0,i.getRandomBetween)(0,255)),g:Math.floor((0,i.getRandomBetween)(0,255)),b:Math.floor((0,i.getRandomBetween)(0,255))}}constructBackgroundNpc(){this.colorRGB=this.getRandomRGB();let e=Math.floor((0,i.getRandomBetween)(40,100));const t=this.scene.third.add.cone({x:this.spawnPos.x,y:this.spawnPos.y,z:this.spawnPos.z,radius:.4,height:1.1},{lambert:{color:`rgb(${e}, ${e}, ${e})`}}),s=this.scene.third.add.sphere({radius:.3,y:.3,z:.02},{lambert:{color:`rgb(${e}, ${e}, ${e})`}});this.scene.third.physics.add.existing(t,{shape:"box",offset:{y:-.1},height:1.4,width:.7,mass:10}),this.npcObj3D=t.add(s),this.npcObj3D.body.setDamping(.8,.8),this.npcObj3D.body.setFriction(.8),this.npcObj3D.userData={isColored:!1,isGround:!0},this.npcObj3D.body.on.collision(((e,t)=>{var s;e.userData.name!==o.ZAP||this.npcObj3D.userData.isColored||(null===(s=o.PLAYERREF.player)||void 0===s||s.litObject(),this.npcObj3D.material.color.set(`rgb(${this.colorRGB.r}, ${this.colorRGB.g}, ${this.colorRGB.b})`),this.npcObj3D.children.forEach((e=>{e.material.color.set(`rgb(${this.colorRGB.r}, ${this.colorRGB.g}, ${this.colorRGB.b})`)})),this.npcObj3D.userData.isColored=!0)}))}constructShopItem(e){this.npcObj3D=e.clone(!0),this.npcObj3D.visible=!0,this.npcObj3D.position.set(this.spawnPos.x,this.spawnPos.y,this.spawnPos.z),this.scene.third.add.existing(this.npcObj3D);let t=!1,s=!1,n=this.spawnPos.clone(),a=.8;const r=[n.x-a,n.x+a],h=[n.z-a,n.z+a],d=[n.x-4,n.x+4],c=[n.z-4,n.z+4],l=this.spawnPos.clone();l.y=this.spawnPos.y+2;const p=this.scene.add.star(-150,-150,7,40,50,4210752,.4).setVisible(!1),u=this.scene.add.bitmapText(-100,-100,"battery","100 / 100",30,1).setDepth(1).setVisible(!1);Phaser.Display.Align.In.Center(u,p);let m=this.scene.third.camera.position.distanceTo(n);p.setData("initialDistance",m);const y=e=>{s!==e&&(s=e,p.setVisible(e),u.setVisible(e))};let b=this.scene.tweens.add({targets:n,ease:"sine.inout",duration:200,y:"+=1",useFrames:!0,repeat:-1,yoyo:!0,onUpdate:()=>{if(!t&&o.PLAYERREF.player&&(0,i.checkCollisionWithPlayer)(d,c)){let e=this.scene.third.camera.position.distanceTo(n),s=p.getData("initialDistance")/e;p.setScale(s),y(!0),u.setText(`${this.shopItemData.shopText} \n \n cost: ${this.shopItemData.cost} \n\n walk into me to buy`);let a=this.scene.third.transform.from3dto2d(l);if(p.setPosition(a.x,a.y),Phaser.Display.Align.In.Center(u,p),(0,i.checkCollisionWithPlayer)(r,h)){const e=o.PLAYERREF.player.getCoinDiff(this.shopItemData);if(e<=0)return o.PLAYERREF.player.purchaseItem(this.shopItemData),this.shopItemData.restockTime?(this.npcObj3D.visible=!1,t=!0,void setTimeout((()=>{t=!1,this.npcObj3D.visible=!0}),this.shopItemData.restockTime)):(p.destroy(),u.destroy(),(0,i.disposeMesh)(this.scene,this.npcObj3D),null==b||b.remove(),void(b=void 0));u.setText(`You require \n ${e} more coin(s) \n to buy this`),Phaser.Display.Align.In.Center(u,p)}}else y(!1);this.npcObj3D.position.set(n.x,n.y,n.z),this.npcObj3D.rotateX(.03)}})}respawn(){this.npcObj3D.body.setCollisionFlags(2),this.npcObj3D.rotation.set(0,0,0),this.npcObj3D.position.set(this.spawnPos.x,this.spawnPos.y,this.spawnPos.z),this.npcObj3D.body.needUpdate=!0,this.npcObj3D.body.once.update((()=>{this.npcObj3D.body.setCollisionFlags(0),this.npcObj3D.body.setVelocity(0,0,0),this.npcObj3D.body.setAngularVelocity(0,0,0)}))}update(e,t){this.npcObj3D.position.y<o.OUTOFBOUNDSY&&this.respawn()}}},170:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,o)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&i(t,e,s);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(277),h=s(90),d=a(s(555)),c=n(s(444)),l=s(144),p=a(s(177)),u=s(454);class m extends r.ExtendedObject3D{constructor(e){super(),this.infiJump=!1,this.currentHP=100,this.maxHP=100,this.currentLevel=1,this.currentExp=0,this.expNextLevel=10,this.dmgFactor=1,this.weapons={},this.weaponUIBoxes={},this.uI3DObjs={},this.uI3DObjsKeys=[],this.speed=5,this.coinCount=0,this.potionCount=0,this.canDrink=!0,this.numLitObjs=0,this.litTextPercent=0,this.alive=!0,this.respawning=!1,this.isLevelingUp=!1,this.setAnim=!1,this.audios={},this.isMuted=!1,this.scene=e,this.loadScreenText(),this.setUpAudio(),this.setUpKeys(),this.loadPlayer(),this.loadPotion(),this.loadHPBar(),this.loadWeaponBar(),this.loadPotionBar(),this.loadExpBar(),this.loadCoinBar(),this.loadPercentLitText(),this.loadCrossHair()}setUpAudio(){this.audios.background=this.scene.sound.add("background",{loop:!0}),this.audios.boss=this.scene.sound.add("boss",{loop:!0}),this.audios.wep1=this.scene.sound.add("wep1"),this.audios.wep2=this.scene.sound.add("wep2"),this.audios.wep3=this.scene.sound.add("wep3"),this.audios.coin=this.scene.sound.add("coin"),this.audios.exp1=this.scene.sound.add("exp1"),this.audios.exp2=this.scene.sound.add("exp2"),this.audios.levelup=this.scene.sound.add("levelup"),this.audios.victory=this.scene.sound.add("victory"),this.audios.drink=this.scene.sound.add("drink"),this.audios.buy=this.scene.sound.add("buy"),this.muteText=this.scene.add.bitmapText(0,0,"battery","",26,1).setDepth(1),Phaser.Display.Align.In.TopLeft(this.muteText,this.sceneAsRect),this.isMuted=!1}loadPlayer(){this.scene.third.load.gltf("assets/glb/BatteryMageWithAllWandsV1.glb").then((e=>{const t=e.scene.children[0];this.userData.name=h.MAGE,this.add(t),this.position.set(0,0,0),this.scale.setScalar(.5);const s="EmitZone";this.traverse((e=>{if(e.isMesh){if(e.name.includes(s)){const t=e.name.replace(s,"");this.weapons[t]=new d.default(this.scene,h.WEAPONS[t],e)}e.castShadow=e.receiveShadow=!0,e.material.roughness=1,e.material.metalness=0}})),this.activeWeapon=this.weapons[h.WEAPONNAMES[0]],this.activeWeapon.weapon.visible=!0,this.createShopWeapons(),this.scene.third.animationMixers.add(this.anims.mixer),e.animations.forEach((e=>{e.name&&this.anims.add(e.name,e)})),this.anims.play("idle"),this.audios.background.play(),this.scene.third.add.existing(this),this.scene.third.physics.add.existing(this,{shape:"box",offset:{y:-.55},height:2}),h.PLAYERREF.player=this;const i=new r.ExtendedObject3D;i.position.setY(-.5),this.scene.third.physics.add.existing(i,{mass:1e-8,shape:"box",width:.2,height:.1,depth:.2}),i.body.setCollisionFlags(4),this.scene.third.physics.add.constraints.lock(this.body,i.body),i.body.on.collision(((e,t)=>{e.userData.isGround&&(this.canJump="end"!==t),this.infiJump&&(this.canJump=!0)})),this.body.setFriction(.8),this.body.setAngularFactor(0,0,0),this.controls=new r.ThirdPersonControls(this.scene.third.camera,this,{offset:new r.THREE.Vector3(0,1.5,.4),targetRadius:4}),this.scene.third.camera.near=2,this.scene.third.camera.updateProjectionMatrix(),this.scene.input.on("pointerdown",(()=>{this.scene.input.mouse.requestPointerLock()})),this.scene.input.on("pointermove",(e=>{this.scene.input.mouse.locked&&this.controls.update(e.movementX,e.movementY)})),this.scene.events.on("update",(()=>{this.controls.update(0,0)})),this.keys.slot1.on("down",(()=>{this.swapToWeapon(h.WEAPONNAMES[0])})),this.keys.slot2.on("down",(()=>{this.swapToWeapon(h.WEAPONNAMES[1])})),this.keys.slot3.on("down",(()=>{this.swapToWeapon(h.WEAPONNAMES[2])})),this.keys.slotHP.on("down",(()=>{this.alive&&this.usePotion()}))}))}loadPotion(){this.scene.third.load.gltf("assets/glb/Potion.glb").then((e=>{const t=new r.ExtendedObject3D;t.add(e.scene.children[0]),t.position.set(-1.5,0,45),t.scale.setScalar(.3),this.scene.third.add.existing(t),new c.default(this.scene,c.NpcTypes.ShopItem,new r.THREE.Vector3(5.5,-1,40),t,h.POTION),this.uI3DObjs[h.POTION.name]=new p.default(this.scene,this.potionUIBox,t,!1),this.uI3DObjsKeys.push(h.POTION.name)}))}loadHPBar(){let e=this.scene.add.rectangle(0,0,h.HPBARWIDTH+5,45,5923742);e.setPosition(.5*this.scene.scale.width,this.scene.scale.height-27),this.playerHPBar=this.scene.add.rectangle(0,0,h.HPBARWIDTH,40,h.HPCOLOR),Phaser.Display.Align.In.Center(this.playerHPBar,e),this.hPText=this.scene.add.bitmapText(0,0,"battery",`${this.currentHP} / ${this.maxHP}`,30).setDepth(1),Phaser.Display.Align.In.Center(this.hPText,this.playerHPBar)}loadWeaponBar(){const e=16776960;let t=this.scene.add.rectangle(0,0,200,45,5923742);t.setPosition(.21*this.scene.scale.width,this.scene.scale.height-27),t.isFilled=!1,t.setStrokeStyle(5,5923742);const s=this.scene.add.rectangle(0,0,60,40,16776960).setAlpha(h.UIBOXALPHA);s.isFilled=!1,s.setStrokeStyle(3,e),Phaser.Display.Align.In.LeftCenter(s,t,-5);const i=this.scene.add.text(0,0,"1",{fontSize:"22px",color:"#000000"}).setDepth(1).setAngle(-20);Phaser.Display.Align.In.TopLeft(i,s),this.weaponUIBoxes[h.WEAPONNAMES[0]]=s;const o=this.scene.add.rectangle(0,0,60,40,16776960).setAlpha(h.UIBOXALPHA);o.isFilled=!1,o.setStrokeStyle(3,e),Phaser.Display.Align.In.LeftCenter(o,t,-70);const n=this.scene.add.text(0,0,"2",{fontSize:"22px",color:"#000000"}).setDepth(1).setAngle(-20);Phaser.Display.Align.In.TopLeft(n,o),this.weaponUIBoxes[h.WEAPONNAMES[1]]=o;const a=this.scene.add.rectangle(0,0,60,40,16776960).setAlpha(h.UIBOXALPHA);a.isFilled=!1,a.setStrokeStyle(3,e),Phaser.Display.Align.In.LeftCenter(a,t,-135);const r=this.scene.add.text(0,0,"3",{fontSize:"22px",color:"#000000"}).setDepth(1).setAngle(-20);Phaser.Display.Align.In.TopLeft(r,a),this.weaponUIBoxes[h.WEAPONNAMES[2]]=a}loadScreenText(){this.sceneAsRect=this.scene.add.rectangle(.5*this.scene.scale.width,.5*this.scene.scale.height,this.scene.scale.width,this.scene.scale.height).setVisible(!1),this.announcementText=this.scene.add.bitmapText(0,0,"battery","",30,1).setDepth(1),Phaser.Display.Align.In.Center(this.announcementText,this.sceneAsRect),this.victoryText=this.scene.add.bitmapText(0,0,"battery","",40,1).setDepth(1).setVisible(!1),Phaser.Display.Align.In.Center(this.victoryText,this.sceneAsRect,0,-100)}isAlive(){return this.alive}isRespawning(){return this.respawning}loadPotionBar(){let e=this.scene.add.rectangle(0,0,75,45,5923742);e.setPosition(.7*this.scene.scale.width,this.scene.scale.height-27),e.isFilled=!1,e.setStrokeStyle(5,5923742),this.potionUIBox=this.scene.add.rectangle(0,0,70,40,16776960).setAlpha(h.UIBOXALPHA),Phaser.Display.Align.In.Center(this.potionUIBox,e),this.potionUIBox.isFilled=!1,this.potionUIBox.setStrokeStyle(3,16776960);const t=this.scene.add.text(0,0,"7",{fontSize:"22px",color:"#000000"}).setDepth(1).setAngle(-20);Phaser.Display.Align.In.TopLeft(t,this.potionUIBox),this.potionCountText=this.scene.add.bitmapText(0,0,"battery",`${this.potionCount}`,20).setDepth(1),Phaser.Display.Align.In.BottomRight(this.potionCountText,this.potionUIBox)}loadCoinBar(){let e=this.scene.add.rectangle(0,0,95,45,5923742).setVisible(!1);e.setPosition(.78*this.scene.scale.width,this.scene.scale.height-27);const t=this.scene.add.circle(0,0,10,16441863);Phaser.Display.Align.In.LeftCenter(t,e),this.coinCountText=this.scene.add.bitmapText(0,this.scene.scale.height-42,"battery",`${this.coinCount}`,30).setDepth(1),Phaser.Display.Align.In.LeftCenter(this.coinCountText,e,-25)}loadPercentLitText(){this.percentLitText=this.scene.add.bitmapText(10,this.scene.scale.height-40,"battery","0% Lit",30).setDepth(1)}litObject(){this.numLitObjs++;const e=Math.floor(this.numLitObjs/h.LIGHTUPPABLES*100);e!==this.litTextPercent&&(this.litTextPercent=e,this.scene.tweens.add({targets:this.percentLitText,ease:"sine.inout",duration:100,scale:1.2,useFrames:!1,yoyo:!0,onComplete:()=>{this.percentLitText.setText(`${e}% Lit`)}}),100===e&&this.audios.victory.play())}loadExpBar(){let e=this.scene.add.star(0,0,7,65,85,5923742);e.setPosition(.9*this.scene.scale.width,this.scene.scale.height-36),this.expBar=this.scene.add.star(0,0,7,60,80,16776960).setAlpha(.9),Phaser.Display.Align.In.Center(this.expBar,e),this.expText=this.scene.add.bitmapText(0,0,"battery",`Level ${this.currentLevel} \n 0.0%`,20,1).setDepth(1),Phaser.Display.Align.In.Center(this.expText,this.expBar),this.expBar.setScale(0)}setUpKeys(){this.keys={w:this.scene.input.keyboard.addKey("w"),z:this.scene.input.keyboard.addKey("z"),a:this.scene.input.keyboard.addKey("a"),q:this.scene.input.keyboard.addKey("q"),s:this.scene.input.keyboard.addKey("s"),d:this.scene.input.keyboard.addKey("d"),interact:this.scene.input.keyboard.addKey("e"),slot1:this.scene.input.keyboard.addKey(49),slot2:this.scene.input.keyboard.addKey(50),slot3:this.scene.input.keyboard.addKey(51),slotHP:this.scene.input.keyboard.addKey(55),space:this.scene.input.keyboard.addKey(32),m:this.scene.input.keyboard.addKey("m")},this.keys.m.on("down",(()=>{this.scene.sound.mute?this.muteText.setText(""):this.muteText.setText("Game muted"),this.scene.sound.mute=!this.scene.sound.mute}))}loadCrossHair(){this.crossHair=this.scene.add.circle(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,4,238),this.crossHair.depth=2}bossFight(){this.audios.background.isPlaying&&this.audios.background.stop(),this.audios.boss.isPlaying||this.audios.boss.play()}createShopWeapons(){const e=[new r.THREE.Vector3(0,0,0),new r.THREE.Vector3(5.5,-1,45),new r.THREE.Vector3(5.5,-1,50)];for(let t=1;t<h.WEAPONNAMES.length;t++)new c.default(this.scene,c.NpcTypes.ShopItem,e[t],this.weapons[h.WEAPONNAMES[t]].weapon,this.weapons[h.WEAPONNAMES[t]].weaponData);this.createWeapon3DUIs()}createWeapon3DUIs(){for(let e=0;e<h.WEAPONNAMES.length;e++){const t=h.WEAPONNAMES[e];this.uI3DObjs[t]=new p.default(this.scene,this.weaponUIBoxes[t],this.weapons[t].weapon),this.uI3DObjsKeys.push(t)}this.uI3DObjs[h.WEAPONNAMES[0]].setScale(h.ACTIVEWEPSCALE3DUI),this.uI3DObjs[h.WEAPONNAMES[0]].setVisibility(!0)}jump(){this.anims.play("jumping",0,!1),this.body.setVelocityY(5),this.infiJump||(this.canJump=!1)}respawn(){this.audios.background.play(),this.respawning=!0,setTimeout((()=>{this.respawning=!1}),100),this.currentHP=20,this.updateHPUI(),this.body.setCollisionFlags(2),this.position.set(0,4,0),this.body.needUpdate=!0,this.body.once.update((()=>{this.body.setCollisionFlags(0),this.body.setVelocity(0,0,0),this.body.setAngularVelocity(0,0,0)}))}updateHPUI(){const e=this.currentHP*h.HPBARWIDTH/this.maxHP;this.playerHPBar.setSize(e,this.playerHPBar.height),this.hPText.setText(`${this.currentHP} / ${this.maxHP}`),Phaser.Display.Align.In.Center(this.hPText,this.playerHPBar)}updateExpUI(){const e=this.currentExp/this.expNextLevel,t=(100*e).toFixed(1);this.expBar.setScale(e),this.expText.setText(`Level ${this.currentLevel} \n ${t}%`)}playBossVictorySequence(){const e=["Congrats! You defeated the power hungry king!","He was draining the power from the world \n to power his 64K TV!","You have now unlocked inifite jump. \n Feel free to checkout the lands you have repowered.","Thanks for playing!"];this.audios.victory.play();const t=s=>{s<e.length?(1===s&&(this.scene.third.physics.add.box({x:120,y:3,z:115.5,width:10,height:8,depth:1},{lambert:{color:"black"}}).rotateY(.79),this.infiJump=!0),this.victoryText.setText(e[s]).setVisible(!0),Phaser.Display.Align.In.Center(this.victoryText,this.sceneAsRect,0,-100),setTimeout((()=>{t(++s)}),8e3)):(this.victoryText.setVisible(!1),this.audios.boss.stop(),this.audios.background.play())};setTimeout((()=>{t(0)}),130)}levelUp(){this.isLevelingUp=!0,this.audios.levelup.play(),this.scene.tweens.add({targets:this.expBar,ease:"sine.inout",duration:130,angle:360,scale:1.2,useFrames:!1,yoyo:!0,onComplete:()=>{this.currentLevel++,this.currentExp-=this.expNextLevel,this.expNextLevel+=h.EXPNEXTLEVELINCREMENTAMT,this.updateExpUI();const e=Math.floor(1.1*this.maxHP)-this.maxHP;this.maxHP+=e,this.currentHP+=e,this.updateHPUI(),this.dmgFactor*=1.1,this.isLevelingUp=!1}}),this.announcementText.setText("HP +10% \n DMG +10%").setAlpha(1),Phaser.Display.Align.In.Center(this.announcementText,this.sceneAsRect),this.scene.tweens.add({targets:this.announcementText,ease:"sine.inout",duration:1e3,alpha:0,y:this.announcementText.y-100})}tookDamage(e){!1!==this.alive&&(this.currentHP-=e,this.currentHP<=0&&(this.currentHP=0,this.die()),this.updateHPUI())}die(){this.alive=!1;let e=3;this.anims.play("dying",0,!1),this.audios.background.stop(),this.audios.boss.stop(),this.announcementText.setText("You Died...").setAlpha(1),Phaser.Display.Align.In.Center(this.announcementText,this.sceneAsRect),this.scene.tweens.add({targets:this.announcementText,ease:"sine.inout",duration:h.PLAYERRESPAWNTIME/3,alpha:0,repeat:3,onRepeat:()=>{this.announcementText.setText(`Respawning in... ${e}`).setAlpha(1),Phaser.Display.Align.In.Center(this.announcementText,this.sceneAsRect),e--},onComplete:()=>{this.alive=!0,this.respawn()}})}swapToWeapon(e){this.weapons[e].canSwapTo()&&(this.uI3DObjs[this.activeWeapon.weaponData.name].setScale(.05),this.uI3DObjs[e].setScale(.1),this.activeWeapon.weapon.visible=!1,this.activeWeapon=this.weapons[e],this.activeWeapon.weapon.visible=!0)}goOnCooldown(e){this.anims.play("attacking",0,!1);const t=Math.floor((0,u.getRandomBetween)(1,4));this.audios[`wep${t}`].play(),this.weaponUIBoxes[e].setAlpha(0),this.scene.tweens.add({targets:this.weaponUIBoxes[e],duration:this.activeWeapon.weaponData.cooldown,alpha:h.UIBOXALPHA,onComplete:()=>{this.weapons[e].updateCooldown(!1)}})}goOnDrinkCooldown(){this.canDrink=!1,this.audios.drink.play(),this.potionUIBox.setAlpha(0),this.scene.tweens.add({targets:this.potionUIBox,duration:h.DRINKCD,alpha:h.UIBOXALPHA,onComplete:()=>{this.canDrink=!0,this.scene.tweens.add({targets:this.potionUIBox,duration:100,scale:1.1,yoyo:!0})}})}recoilFromWeapon(e){const t=new r.THREE.Vector3;this.scene.third.camera.getWorldDirection(t);const s=Math.atan2(t.x,t.z);let i=Math.sin(s)*e,o=Math.cos(s)*e;this.body.applyForce(-i,0,-o)}pickUp(e){if(e===l.ItemTypes.Coin)this.coinCount++,this.coinCountText.setText(`${this.coinCount}`),this.audios.coin.play();else if(e===l.ItemTypes.EXP){this.currentExp++;const e=Math.floor((0,u.getRandomBetween)(1,3));this.audios[`exp${e}`].play(),this.currentExp>=this.expNextLevel&&!this.isLevelingUp?this.levelUp():this.updateExpUI()}}usePotion(){this.canDrink&&this.potionCount>0&&(this.currentHP+=h.POTIONHEALAMT,this.potionCount--,this.currentHP>this.maxHP&&(this.currentHP=this.maxHP),this.updateHPUI(),this.potionCountText.setText(`${this.potionCount}`),Phaser.Display.Align.In.BottomRight(this.potionCountText,this.potionUIBox),this.potionCount<1&&this.uI3DObjs[h.POTION.name].setVisibility(!1),this.goOnDrinkCooldown())}getCoinDiff(e){return e.cost-this.coinCount}purchaseItem(e){const t=e.name;this.coinCount-=e.cost,this.audios.buy.play(),this.coinCountText.setText(`${this.coinCount}`),t===h.POTION.name?(this.potionCount++,this.potionCountText.setText(`${this.potionCount}`),this.uI3DObjs[h.POTION.name].setVisibility(!0)):void 0!==this.weapons[t]&&(this.weapons[t].weaponData.isUnlocked=!0,this.uI3DObjs[t].setVisibility(!0))}update(e,t){if(!this.body||!this.controls)return;if(!this.alive)return;this.setAnim=!1;const s=new r.THREE.Vector3,i=this.scene.third.camera.getWorldDirection(s),o=Math.atan2(i.x,i.z),n=this.getWorldDirection(s),a=Math.atan2(n.x,n.z);this.body.setAngularVelocityY(0);const d=Math.abs(o-a);let c=5;if(d>h.ROTDIFF&&(d>h.PIMINUSROTDIFF&&(c*=-1),o<a&&(c*=-1),this.body.setAngularVelocityY(c)),this.keys.w.isDown||this.keys.z.isDown){"running"===this.anims.current&&(this.setAnim=!0),"running"===this.anims.current||this.setAnim||(this.anims.play("running"),this.setAnim=!0);let e=Math.sin(o)*this.speed,t=this.body.velocity.y,s=Math.cos(o)*this.speed;this.body.setVelocity(e,t,s)}else if(this.keys.s.isDown){"running"===this.anims.current&&(this.setAnim=!0),"running"===this.anims.current||this.setAnim||(this.anims.play("running"),this.setAnim=!0);let e=.5*this.speed,t=Math.sin(o)*e,s=this.body.velocity.y,i=Math.cos(o)*e;this.body.setVelocity(-t,s,-i)}if(this.keys.a.isDown||this.keys.q.isDown){"running"===this.anims.current&&(this.setAnim=!0),"running"===this.anims.current||this.setAnim||(this.anims.play("running"),this.setAnim=!0);let e=Math.sin(o+h.HALFPI)*this.speed,t=this.body.velocity.y,s=Math.cos(o+h.HALFPI)*this.speed;this.body.setVelocity(e,t,s)}else if(this.keys.d.isDown){"running"===this.anims.current&&(this.setAnim=!0),"running"===this.anims.current||this.setAnim||(this.anims.play("running"),this.setAnim=!0);let e=Math.sin(o-h.HALFPI)*this.speed,t=this.body.velocity.y,s=Math.cos(o-h.HALFPI)*this.speed;this.body.setVelocity(e,t,s)}else"idle"===this.anims.current&&(this.setAnim=!0),"idle"===this.anims.current||this.setAnim||(this.anims.play("idle",0),this.setAnim=!0);this.keys.space.isDown&&this.canJump&&this.jump(),this.position.y<h.OUTOFBOUNDSY&&this.respawn(),this.scene.input.mousePointer.leftButtonDown()&&this.activeWeapon.useWeapon();for(let s of this.uI3DObjsKeys)this.uI3DObjs[s].update(e,t)}}t.default=m},774:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,o)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&i(t,e,s);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(277),h=a(s(372)),d=a(s(170)),c=n(s(444)),l=n(s(501)),p=s(925);class u extends r.Scene3D{constructor(){super({key:"MainScene"}),this.npcs=[],this.monsters=[]}init(){this.accessThirdDimension()}create(){new h.default(this).generateGround(),this.third.warpSpeed("-orbitControls","-ground","-grid"),this.player=new d.default(this),this.loadBatteryHouse(),this.loadBackgroundNpcs(),this.loadKnights(),this.loadBishops(),this.loadRooks(),this.loadBoss()}loadBatteryHouse(){this.third.load.gltf("assets/glb/BatteryHouse.glb").then((e=>{const t=new r.ExtendedObject3D;t.add(e.scene),t.position.set(0,-1.5,0),t.rotation.set(0,-45,0),this.third.add.existing(t),this.third.physics.add.existing(t,{shape:"concaveMesh",mass:0})}))}loadBackgroundNpcs(){const e=[[-1.5,0,45],[5,0,21],[10,0,21],[17,0,10],[1.5,0,35],[8,0,58],[18,0,37],[15,0,25],[24,0,11.5],[50,0,135]];for(let t=0;t<e.length;t++)this.npcs.push(new c.default(this,c.NpcTypes.Background,new r.THREE.Vector3(e[t][0],e[t][1],e[t][2])))}loadKnights(){const e=[[41,0,83],[20,-2,121],[60,-2,105],[72,0,68],[97,0,18],[111,1,75],[135,1,143],[85.5,0,140],[125,-1,25]];this.third.load.gltf("assets/glb/Knight.glb").then((t=>{const s=new r.ExtendedObject3D;s.add(t.scene.children[0]),s.scale.setScalar(.5);for(let t=0;t<e.length;t++)this.monsters.push(new l.default(this,l.MonsterTypes.Knight,new r.THREE.Vector3(e[t][0],e[t][1],e[t][2]),s,p.MONSTERKNIGHTDATA))}))}loadBishops(){const e=[[145,0,114.5],[105,0,142],[79,1,115.5],[140,1,56],[35,1,135]];this.third.load.gltf("assets/glb/Bishop.glb").then((t=>{const s=new r.ExtendedObject3D;s.add(t.scene.children[0]),s.scale.setScalar(.5);for(let t=0;t<e.length;t++)this.monsters.push(new l.default(this,l.MonsterTypes.Bishop,new r.THREE.Vector3(e[t][0],e[t][1],e[t][2]),s,p.MONSTERBISHOPDATA))}))}loadRooks(){const e=[[88,1,130],[139,1,139],[126,1,85]];this.third.load.gltf("assets/glb/Rook.glb").then((t=>{const s=new r.ExtendedObject3D;s.add(t.scene.children[0]),s.scale.setScalar(.5);for(let t=0;t<e.length;t++)this.monsters.push(new l.default(this,l.MonsterTypes.Rook,new r.THREE.Vector3(e[t][0],e[t][1],e[t][2]),s,p.MONSTERROOKDATA))}))}loadBoss(){this.third.load.gltf("assets/glb/Boss.glb").then((e=>{const t=new r.ExtendedObject3D;t.add(e.scene.children[0]),t.scale.setScalar(.5),this.monsters.push(new l.default(this,l.MonsterTypes.Boss,new r.THREE.Vector3(122,1.5,117),t,p.MONSTERBOSSDATA))}))}update(e,t){this.player.update(e,t);for(let s of this.npcs)s.update(e,t);for(let s of this.monsters)s.update(e,t)}}t.default=u},734:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=s(90);class o extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.bitmapFont("battery","assets/fonts/battery-font.png","assets/fonts/battery-font.xml"),this.load.image(i.ZapIMG.ZAP,"assets/img/BatteryMageZap.png"),this.load.image(i.ZapIMG.ZAP2,"assets/img/BatteryMageZap2.png"),this.load.audio("background",["assets/audio/background.ogg","assets/audio/background.mp3"]),this.load.audio("boss",["assets/audio/boss.ogg","assets/audio/boss.mp3"]),this.load.audio("wep1",["assets/audio/wep1.ogg","assets/audio/wep1.mp3"]),this.load.audio("wep2",["assets/audio/wep2.ogg","assets/audio/wep2.mp3"]),this.load.audio("wep3",["assets/audio/wep3.ogg","assets/audio/wep3.mp3"]),this.load.audio("coin",["assets/audio/coin.ogg","assets/audio/coin.mp3"]),this.load.audio("exp1",["assets/audio/exp1.ogg","assets/audio/exp1.mp3"]),this.load.audio("exp2",["assets/audio/exp2.ogg","assets/audio/exp2.mp3"]),this.load.audio("levelup",["assets/audio/levelup.ogg","assets/audio/levelup.mp3"]),this.load.audio("victory",["assets/audio/victory.ogg","assets/audio/victory.mp3"]),this.load.audio("drink",["assets/audio/drink.ogg","assets/audio/drink.mp3"]),this.load.audio("buy",["assets/audio/buy.ogg","assets/audio/buy.mp3"])}create(){this.scene.start("MainScene")}}t.default=o},177:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=s(90);t.default=class{constructor(e,t,s,o=!1){this.z=2.1,this.scene=e,this.rect=t,this.uI3DObj=s.clone(!0),this.uI3DObj.visible=o,this.x=this.rect.x/this.scene.scale.width*2-1,this.y=-this.rect.y/this.scene.scale.height*2+1,this.uI3DObj.scale.setScalar(i.INACTIVEWEPSCALE3DUI),this.scene.third.add.existing(this.uI3DObj)}setVisibility(e){this.uI3DObj.visible=e}setScale(e){this.uI3DObj.scale.setScalar(e)}update(e,t){const s=this.scene.third.transform.from2dto3d(this.x,this.y,this.z);if(s){const{x:e,y:t,z:i}=s;this.uI3DObj.position.set(e,t,i),this.uI3DObj.rotateX(.05),this.uI3DObj.rotateY(.05)}}}},454:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkCollisionWithPlayer=t.disposeMesh=t.getRandomBetween=void 0;const i=s(90);t.getRandomBetween=(e,t)=>Math.random()*(t-e)+e,t.disposeMesh=(e,t)=>{t.geometry.dispose(),t.material.dispose(),e.third.scene.remove(t),e.third.renderer.renderLists.dispose()},t.checkCollisionWithPlayer=(e,t)=>{var s;let o=null===(s=i.PLAYERREF.player)||void 0===s?void 0:s.position;return!!(o&&e[0]<=o.x&&o.x<=e[1]&&t[0]<=o.z&&o.z<=t[1])}},555:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=s(277),o=s(90);t.default=class{constructor(e,t,s){this.onCooldown=!1,this.scene=e,this.weaponData=t,this.emitZone=s,s.visible=!1,s.parent&&(this.weapon=s.parent,this.weapon.visible=!1)}canSwapTo(){return this.weaponData.isUnlocked}updateCooldown(e){this.onCooldown=e}recoilPlayer(){var e;this.weaponData.recoil>0&&(null===(e=o.PLAYERREF.player)||void 0===e||e.recoilFromWeapon(this.weaponData.recoil))}useWeapon(){var e;if(this.onCooldown)return;this.onCooldown=!0,null===(e=o.PLAYERREF.player)||void 0===e||e.goOnCooldown(this.weaponData.name),this.recoilPlayer();const t=new i.THREE.Raycaster;let s=new i.THREE.Vector3,n=new i.THREE.Vector3;t.setFromCamera({x:0,y:0},this.scene.third.camera),this.emitZone.getWorldPosition(s),n.copy(t.ray.direction),n.add(s);for(let e=0;e<this.weaponData.shotNum;e++){const e=this.scene.third.physics.add.sphere({radius:.22,x:n.x,y:n.y,z:n.z,mass:1});e.visible=!1,e.userData.name=o.ZAP,e.userData.damage=this.weaponData.damage,e.userData.hitMonster=!1,e.body.setCcdMotionThreshold(1),e.body.setCcdSweptSphereRadius(.005),e.body.setGravity(0,-1,0),e.body.setFriction(10);const s=this.weaponData.zapImg[Math.floor(Math.random()*this.weaponData.zapImg.length)],a=this.scene.add.image(-100,-100,s);let r=this.scene.third.camera.position.distanceTo(e.position);a.setData("initialDistance",r),this.scene.tweens.add({targets:a,duration:this.weaponData.duration,useFrames:!0,angle:1800,onUpdate:()=>{let t=this.scene.third.camera.position.distanceTo(e.position),s=a.getData("initialDistance")/t;a.setScale(s);let i=this.scene.third.transform.from3dto2d(e.position);a.setPosition(i.x,i.y)},onComplete:()=>{this.scene.third.destroy(e),a.destroy()}});let h=new i.THREE.Vector3;h.copy(t.ray.direction),h.multiplyScalar(this.weaponData.force);let d=h.x*this.weaponData.force,c=h.y*this.weaponData.force,l=h.z*this.weaponData.force;this.weaponData.spread&&(d*=20*Math.random(),c*=20*Math.random(),l*=20*Math.random()),setTimeout((()=>{e.body.applyForce(d,c,l)}),2)}}}}},s={};function i(e){var o=s[e];if(void 0!==o)return o.exports;var n=s[e]={exports:{}};return t[e].call(n.exports,n,n.exports,i),n.exports}i.m=t,e=[],i.O=(t,s,o,n)=>{if(!s){var a=1/0;for(c=0;c<e.length;c++){for(var[s,o,n]=e[c],r=!0,h=0;h<s.length;h++)(!1&n||a>=n)&&Object.keys(i.O).every((e=>i.O[e](s[h])))?s.splice(h--,1):(r=!1,n<a&&(a=n));if(r){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,o,n]},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var o,n,[a,r,h]=s,d=0;if(a.some((t=>0!==e[t]))){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(h)var c=h(i)}for(t&&t(s);d<a.length;d++)n=a[d],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(c)},s=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var o=i.O(void 0,[96],(()=>i(985)));o=i.O(o)})();